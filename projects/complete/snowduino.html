<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <!-- Always force latest IE rendering engine or request Chrome Frame -->
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">

    <!-- Use title if it's in the page YAML frontmatter -->
    <title>Snowduino</title>

    <link href="../../favicon.ico" rel="icon" type="image/ico" />

    <!-- Stylesheets -->
    <link href="../../stylesheets/normalize.css" rel="stylesheet" type="text/css" /><link href="../../stylesheets/all.css" rel="stylesheet" type="text/css" />
    <link href="http://getbootstrap.com/dist/css/bootstrap.css" rel="stylesheet" type="text/css" />
    <link href="../../stylesheets/extras.css" rel="stylesheet" type="text/css" />
    <link href="../../stylesheets/offcanvas.css" rel="stylesheet" type="text/css" />


    <!-- Javascript -->
    <script src="http://code.jquery.com/jquery.min.js" type="text/javascript"></script>
    <script src="http://getbootstrap.com/dist/js/bootstrap.js" type="text/javascript"></script>
    <script src="../../javascripts/offcanvas.js" type="text/javascript"></script>

    <!-- Nav Bar Selection -->
    <script>
      $(document).ready(function(){
        $("#").addClass("active");
      });
    </script>

    <!-- Background Selection -->
    <script>
       $(document).ready(function() {
         var bg_img_url = SelectRandomBackgroundImageURL();
         SetImageAsBackground(bg_img_url);
       });

      function SelectRandomBackgroundImageURL(){
         var images = ['01.jpg', '02.jpg', '03.jpg', 
            '04.jpg', '05.jpg', '06.jpg'];

            var chosen_image_name = images[
              Math.floor(
                Math.random() * images.length
              )
            ];

            // I have to use a URL to an actual resource
            // in order to get this relative URL to work properly
            // Ideally I could just get the URL to the directory
            // So I'll get the URL to this resource and then delete the last
            // few characters to get the relative URL to the directory...
            var specific_image_url = '../../images/backgrounds/blue.jpg';
            var image_directory_url = DirectoryURLFromFileURL(specific_image_url);

            var chosen_image_url = image_directory_url + chosen_image_name;
            return chosen_image_url;
      }

      function DirectoryURLFromFileURL(file_url){
         var last_slash_index = file_url.lastIndexOf("/");
         var directory_url = file_url.substring(
              0,last_slash_index+1);
         return directory_url;
      }

      function SetImageAsBackground(chosen_image_url){
          $("#background").attr("src",chosen_image_url);
          $("#background").load(function(evt){
            $("#background").css('opacity','1');
          });
      }
    </script>

  </head>

  <body class="projects projects_complete projects_complete_snowduino">
    <br/>
    <br/>
    <br/>
    <img id="background" src="../../images/background.png" />
    <!-- left padding -->
    <div class="col-md-2"></div>
    <div class="container col-md-8 well">
    
      <!-- nav bar -->
      <div class="navbar navbar-default" role="navigation">
        <div class="well"> 
            <div class="container-fluid">
              <div class="row">
                  <div class="col-sm-2" id="header_image">
                    <img class="img-rounded" width="65px" src="../../images/UANT_logo.jpg" />
                  </div>
                  <div class="col-sm-10" id="header_text">
                    <h3 id="header_title"><tt> The University of Antarctica </tt></h3>
                    <small id="header_subtitle">A place as real as it is cold, honest. </small>
                  </div>
              </div>
            </div>
        </div>
        <div class="container-fluid">
          <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
              <span class="sr-only">Toggle navigation</span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
          </div>
          <div class="navbar-collapse collapse">
            <ul class="nav navbar-nav">

              <li id="navbar-home">
                <a href="../../">Home</a></li>

              <li id="navbar-blog">
                <a href="../../blog/">Message From the Chancellors</a></li>

              <li id="navbar-academics">
                 <a href="../../academics.html">Academics</a></li>

              <li id="navbar-athletics">
                 <a href="../../athletics.html">Athletics</a></li>

              <li id="navbar-clubs">
                 <a href="../../clubs.html">Clubs</a></li>

              <li id="navbar-aboutuniversity">
                 <a href="../../aboutuniversity.html">About UANT</a></li>

            </ul>
          </div>
        </div>
      </div>

      
  <link href="css/offcanvas.css" rel="stylesheet" type="text/css" />

  <script>
    $(document).ready(function () {
      $('[data-toggle="offcanvas"]').click(function () {
        $('.row-offcanvas').toggleClass('active')
      });
    });
  </script>

  <div class="row row-offcanvas row-offcanvas-right">
    <div class="col-xs-6 col-sm-3 sidebar-offcanvas" id="sidebar">
      <div class="list-group">
        <a class="list-group-item" href="../">Our Projects</a>
        <a class="list-group-item" href="https://github.com/university-of-antarctica">GitHub</a>
        <a class="list-group-item" href="../../aboutus.html">About Us</a>
      </div>
    </div>

    <div class="col-xs-12 col-sm-9">
    
  
    <h1> Snowduino </h1>
    <p><div class="well">
<img class="img-circle" src='../../images/snowduino.jpg' alt="Snowduino">
<p>An arduino uno controls two 8x8 LED matrices.  A banner of scrolling text is displayed on the matrices, comprised of 5x7 characters.  An ethernet shield on the arduino hosts a web server which interprets 
GET requests to control what is displayed on the banner.</p>
</div>
</p>

<p><br>
<div class="well">
  <div class="text-info">
    <b>Try interacting with our setup!</b> <br>
    &nbsp; Just type a message into the box and hit <kbd>&crarr;Enter</kbd>.<br>
    &nbsp; The message should then be visible scrolling across the LEDs! <br>
    &nbsp; You can watch it in our lab via webcam, or a virtual Snowduino.
  </div></p>

<p><div class="row">
    <div class="col-lg-6">
      <div class="input-group">
        <span class="input-group-btn">
          <button id="snowduino_button" class="btn btn-info" type="button"><span class="glyphicon glyphicon-send" aria-hidden="true"></span> Send</button>
        </span>
        <input id="snowduino_message" type="text" class="form-control" placeholder="Hello Snowduino...">
      </div>&lt;!-- /input-group --&gt;
    </div>&lt;!-- /.col-lg-6 --&gt;
    <div class="col-lg-6">
      <div id="sendAlert" class="alert alert-success fade"> Message Sent! </div>
    </div>
  </div>
</div></p>

<div id="snowduino_controls">
 
 <span>

   <button id="show_button" class="btn btn-info"><span class="glyphicon glyphicon-resize-full" aria-hidden="true"></span> Show Virtual Snowduino</button>
   
  <button id="hide_button" class="btn btn-info" style="display:none;"><span class="glyphicon glyphicon-resize-small" aria-hidden="true"></span> Hide Virtual Snowduino</button>

  <button id="inspect_button" class="btn btn-info" type="button" style="display:none;"><span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> Refresh</button>

  </span>


</div>

<p><br></p>

<div id="virtual_or_elfotis_div" class="well">

   <div id="error_messages">
     <div id="elfotis_error" class="alert alert-danger" style="display:none;"> <em> The Elf On the Ice Shelf is sleeping, so you'll have to settle for the virtual snowduino </em> </div>

     <div id="snowduino_error" class="alert alert-danger" style="display:none;"> <em> Snowduino appears to be down right now, check back later! </em> </div>
  </div>

  <div id="loading_messages">
    <div id="elfotis_loading" class="alert alert-info">
      <em> Trying to connect to the Elf on the Ice Shelf ... </em>
    </div>
    <div id="snowduino_loading" class="alert alert-info">
      <em> Trying to connect to Snowduino ... </em>
    </div>
  </div>

  <div id="virtual_snowduino_div" style="display:none;">
    <div>
  <div>
    <div id="virtual_snowduino_div" style="background-image: url(../../images/snowduino_bg.jpg);" > 
      <div id="marquee_div">
        <marquee id="virtual_snowduino_marquee" behavior="scroll" direction="left" scrollamount="9"></marquee>
      </div>
    </div>
  </div>
  <div class="text-info">
    <em> </em>
  </div>
</div>

<p></div></p>

<p><div id="elfotis_div" style="display:none;">
    <div>
  <div class="embed-responsive embed-responsive-16by9">
    <iframe class="embed-responsive-item" src="http://gpwclark.net:8283/jsfs.html"></iframe>
  </div>
  <div class="text-info">
  &nbsp;<em>You may click on the video feed to zoom in and get a closer view!</em>
  </div>
</div>
  </div></p>

<p></div></p>

<script>

  // KeepVirtualSnowduinoUpToDate();
  $(document).ready(function(){

    InspectSnowduino();
    EnableSubmitButton();
    EnableInspectButton();
    RedefineEnterKeyBehavior();
    EnableShowVirtualSnowduinoButton();
    EnableHideVirtualSnowduinoButton();
    TestSnowduino();
    TestElfotis();
    OnlyShowWorkingService();

  });

    function OnlyShowWorkingService(){
      $.ajax({
        url: "http://www.gpwclark.net:8283/jsfs.html",
        success: function(response){
          ShowElfotis();
        },
        error: function(xhr, status, error) {
          ShowVirtualSnowduinoIfItIsWorking();
        }
      });
    }
    function ShowVirtualSnowduinoIfItIsWorking(){
      $.ajax({
        url: "http://www.gpwclark.net:8282/?inspect=yes",
        success: function(response){
          ShowVirtualSnowduino();
        },
        error: function(xhr, status, error){

        }
      });
    }

    function TestSnowduino(){
       $.ajax({
        url: "http://www.gpwclark.net:8282/?inspect=yes",
        success: function(response){
          HideSnowduinoLoadingText();
        },
        error: function(xhr, status, error){
          ShowSnowduinoErrorText();
          HideSnowduinoLoadingText();
        }
      });
    }

    function TestElfotis(){
       $.ajax({
        url: "http://www.gpwclark.net:8283/jsfs.html",
        success: function(response){
          HideElfotisLoadingText();
        },
        error: function(xhr, status, error){
          ShowElfotisErrorText();
          HideElfotisLoadingText();
        }
      });
    }

    function HideSnowduinoLoadingText(){
      $("#snowduino_loading").hide();
    }

    function HideElfotisLoadingText(){
      $("#elfotis_loading").hide();
    }

    function ShowSnowduinoErrorText(){
      $("#snowduino_error").show();
    }

    function ShowElfotisErrorText(){
      $("#elfotis_error").show();
    }

    function ShowVirtualSnowduino(){
      $("#show_button").hide();
      $("#virtual_snowduino_div").show();
    }

    function HideVirtualSnowduino(){
      $("#show_button").show();
      $("#virtual_snowduino_div").hide();
    }

    function ShowElfotis(){
      $("#elfotis_div").show();
    }
    function HideElfotis(){
      $("#elfotis_div").hide();
    }

    function EnableHideVirtualSnowduinoButton(){
     $("#hide_button").click(function(){
       HideVirtualSnowduino();
       HideVirtualSnowduinoControls();
       ShowElfotis();
      });
    }

    function EnableShowVirtualSnowduinoButton(){
      $("#show_button").click(function(){
        ShowVirtualSnowduino();
        ShowVirtualSnowduinoControls();
        HideElfotis();
      });
    }

    function HideVirtualSnowduinoControls(){
      $("#show_button").show();
      $("#hide_button").hide();
      $("#inspect_button").hide();
    }

    function ShowVirtualSnowduinoControls(){
      $("#show_button").hide();
      $("#hide_button").show();
      $("#inspect_button").show();
    }

    function EnableSubmitButton(){
      $("#snowduino_button").click(function(){
        SendAndClearSnowduinoForm();
      });
    }

    function SendBannerMessageToSnowduino(message){
      $.ajax({
          url: "http://www.gpwclark.net:8282/?banner="+message
        });
    }

    function KeepVirtualSnowduinoUpToDate(){
       InspectSnowduino();
       setTimeout(function(){
         KeepVirtualSnowduinoUpToDate();
       },
       3000);
    }

    function InspectSnowduino(){
      $.ajax({
          url: "http://www.gpwclark.net:8282/?inspect=yes",
          success: function(response){
            SetVirtualSnowduino(response);
          },
          error: function(xhr, status, error){
            // ShowSnowduinoErrorText();
          }
        });
    }

    function EnableInspectButton(){
        $("#inspect_button").click(function(){
          InspectSnowduino();
        });
    }
    function SetVirtualSnowduino(marquee){
      $("#virtual_snowduino_marquee").html(marquee);

    }
    function SendAndClearSnowduinoForm(){
      SendSnowduinoForm();
      ClearSnowduinoForm();
      InspectSnowduino();
    }

      function SendSnowduinoForm(){
        var message = $("#snowduino_message").val();
        SendBannerMessageToSnowduino(message);
        showSendAlert();
      }
      
      function ClearSnowduinoForm(){
        $("#snowduino_message").val("");
      }

    function showSendAlert(){
      var alert_duration_in_ms = 4000;
      $("#sendAlert").addClass("in");
      setTimeout(function(){
        $("#sendAlert").removeClass("in")
      },alert_duration_in_ms);
    }

  // Prevent default "Enter" key use on the form

  function RedefineEnterKeyBehavior(){
    $("input").keydown(function(event){
      if(event.keyCode == 13) {
        event.preventDefault();
        SendAndClearSnowduinoForm();
        return false;
      }
    });
  }

</script>


  </div>

    </div>

  </div>


    </div> <!-- end container -->  
    <!-- right padding -->
    <div class="col-md-2"></div> 
  </body>
</html>
